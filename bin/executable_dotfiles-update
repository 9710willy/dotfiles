#!/bin/bash
# dotfiles-update - Update dotfiles and tools
# Usage: dotfiles-update

set -euo pipefail

echo "=== Updating Dotfiles ==="

echo ""
echo "→ Pulling latest dotfiles..."
chezmoi update --apply

echo ""
echo "→ Updating Homebrew packages..."
brew update && brew upgrade

echo ""
echo "→ Updating mise tools..."
mise upgrade

echo ""
echo "→ Updating zsh plugins..."
for plugin in ~/powerlevel10k ~/.oh-my-zsh/custom/plugins/*; do
    if [[ -d "$plugin/.git" ]]; then
        echo "  Updating $(basename "$plugin")..."
        git -C "$plugin" pull --quiet
    fi
done

echo ""
echo "→ Updating neovim plugins..."
nvim --headless "+Lazy! sync" +qa 2>/dev/null || echo "  (skipped - run manually with :Lazy sync)"

echo ""
echo "=== Update Complete ==="
echo "Run 'dotfiles-health' to verify setup."
